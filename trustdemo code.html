<pre><font color="#007f69">globals</font><font color="#000000">[<br />  money-of-society<br />]<br /></font><font color="#660096">breed</font><font color="#000000"> [ copycats copycat ]<br /></font><font color="#660096">breed</font><font color="#000000"> [ gurdgers gurdger ]<br /></font><font color="#660096">breed</font><font color="#000000"> [ cheaters cheater ]<br /></font><font color="#660096">breed</font><font color="#000000"> [ cooperators cooperator ]<br /></font><font color="#007f69">turtles-own</font><font color="#000000"> [<br />  time<br />  money<br />  nextdo<br />  coupl?<br />  partner<br />]<br /></font><font color="#5a5a5a">;;time is ticks left for each deal, 10 is default number</font><font color="#000000"><br /></font><font color="#5a5a5a">;;every turtle have money, once turn to 0 or lower, death is happen</font><font color="#000000"><br /></font><font color="#5a5a5a">;;nextdo is cooperate or not of next tick, 1 is coorperate, 0 is not</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  create-copycats numOfCopycat<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  create-gurdgers numOfGurdger<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  create-cheaters numOfCheater<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">0</font><font color="#000000"><br />  ]<br />  create-cooperators numOfCooperator<br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">pink</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000">[<br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">shape</font><font color="#000000"> </font><font color="#963700">&quot;person&quot;</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">5</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> money </font><font color="#963700">50</font><font color="#000000"><br />    </font><font color="#0000aa">setxy</font><font color="#000000"> </font><font color="#660096">random-xcor</font><font color="#000000"> </font><font color="#660096">random-ycor</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">false</font><font color="#000000"><br />  ]<br />  <br />  </font><font color="#0000aa">let</font><font color="#000000"> population-of-society  numOfCopycat </font><font color="#660096">+</font><font color="#000000"> numOfGurdger </font><font color="#660096">+</font><font color="#000000"> numOfCheater </font><font color="#660096">+</font><font color="#000000"> numOfCooperator <br />  </font><font color="#0000aa">set</font><font color="#000000"> money-of-society population-of-society </font><font color="#660096">*</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000"><br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">any?</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> [</font><font color="#0000aa">stop</font><font color="#000000">]<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> coupl? [ deal ] [ couple ]<br />    death<br />    move<br />    </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> show-money? [</font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> money][ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">label</font><font color="#000000"> </font><font color="#963700">&quot;&quot;</font><font color="#000000">]<br />    reproduce<br />  ]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> reproduce<br />  </font><font color="#0000aa">if</font><font color="#000000"> money </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">hatch</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> <br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">5</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> money </font><font color="#963700">50</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> partner </font><font color="#963700">nobody</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">false</font><font color="#000000"><br />      </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"> </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />    ]<br />    </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">50</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> deal<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> nextdo </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> <br />  [<br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> [nextdo] </font><font color="#660096">of</font><font color="#000000"> partner </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> <br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> partner [ </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">]<br />      </font><font color="#0000aa">set</font><font color="#000000"> money-of-society money-of-society </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">4</font><font color="#000000"><br />    ]<br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> partner [ </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000">]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"><br />      [<br />        </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">0</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> [</font><font color="#660096">color</font><font color="#000000">] </font><font color="#660096">of</font><font color="#000000"> partner </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> <br />      [<br />        </font><font color="#0000aa">ask</font><font color="#000000"> partner [ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000">]<br />      ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> money-of-society money-of-society </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />    ]<br />  ]<br />  [<br />    </font><font color="#0000aa">if</font><font color="#000000"> [nextdo] </font><font color="#660096">of</font><font color="#000000"> partner </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />    [<br />      </font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"><br />      </font><font color="#0000aa">ask</font><font color="#000000"> partner [</font><font color="#0000aa">set</font><font color="#000000"> money money </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"><br />      [<br />        </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"><br />      ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> [ </font><font color="#660096">color</font><font color="#000000"> ] </font><font color="#660096">of</font><font color="#000000"> partner </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> </font><font color="#660096">or</font><font color="#000000"> [ </font><font color="#660096">color</font><font color="#000000"> ] </font><font color="#660096">of</font><font color="#000000"> partner </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">yellow</font><font color="#000000"><br />      [<br />        </font><font color="#0000aa">ask</font><font color="#000000"> partner [ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">0</font><font color="#000000"> ]<br />      ]<br />      </font><font color="#0000aa">set</font><font color="#000000"> money-of-society money-of-society </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"><br />    ]<br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> time time </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> partner [ </font><font color="#0000aa">set</font><font color="#000000"> time time </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">]<br />  </font><font color="#0000aa">if</font><font color="#000000"> time </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">[ decouple ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> couple<br />  </font><font color="#0000aa">set</font><font color="#000000"> partner </font><font color="#660096">one-of</font><font color="#000000"> (</font><font color="#660096">turtles-at</font><font color="#000000"> </font><font color="#963700">-1</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">with</font><font color="#000000"> [ </font><font color="#660096">not</font><font color="#000000"> coupl? ]<br />  </font><font color="#0000aa">if</font><font color="#000000"> partner </font><font color="#660096">!=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"><br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">10</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">true</font><font color="#000000"><br />    </font><font color="#0000aa">ask</font><font color="#000000"> partner <br />    [ <br />      </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">10</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">true</font><font color="#000000"><br />      </font><font color="#0000aa">set</font><font color="#000000"> partner </font><font color="#660096">myself</font><font color="#000000"><br />    ]<br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> death <br />  </font><font color="#0000aa">if</font><font color="#000000"> money </font><font color="#660096">&lt;=</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> <br />  [<br />    </font><font color="#0000aa">if</font><font color="#000000"> coupl? <br />    [<br />      decouple<br />    ]<br />    </font><font color="#0000aa">die</font><font color="#000000"><br />  ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> decouple<br />  </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">10</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">false</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> partner <br />  [<br />    </font><font color="#0000aa">set</font><font color="#000000"> time </font><font color="#963700">10</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> coupl? </font><font color="#963700">false</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> partner </font><font color="#963700">nobody</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">0</font><font color="#000000">][ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"> ]<br />  ]<br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">0</font><font color="#000000">][ </font><font color="#0000aa">set</font><font color="#000000"> nextdo </font><font color="#963700">1</font><font color="#000000"> ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> partner </font><font color="#963700">nobody</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> move<br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> coupl?<br />  [<br />    </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">360</font><font color="#000000"><br />    </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">10</font><font color="#000000"><br />  ]<br />  </font><font color="#0000aa">set</font><font color="#000000"> money-of-society money-of-society </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"><br /></font><font color="#007f69">end</font>
</pre>
